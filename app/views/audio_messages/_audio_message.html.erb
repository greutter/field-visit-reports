<div id="<%= dom_id(audio_message) %>" class="px-6 py-4">
  <div class="flex items-start justify-between">
    <div class="flex-1">
      <div class="flex items-center space-x-3">
        <div class="flex-shrink-0">
          <div class="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center">
            <svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"/>
            </svg>
          </div>
        </div>
        <div class="flex-1 min-w-0">
          <p class="text-sm font-medium text-gray-900">
            Recording #<%= audio_message.id %>
            <% if audio_message.duration_seconds.present? %>
              <span class="text-gray-500 font-normal">(<%= audio_message.duration_seconds %>s)</span>
            <% end %>
          </p>
          <p class="text-xs text-gray-500"><%= audio_message.recorded_at&.strftime("%I:%M %p") %></p>
        </div>
      </div>
      <% if audio_message.audio_file.attached? %>
        <div class="mt-3 ml-13">
          <audio controls class="w-full max-w-md" preload="metadata">
            <source src="<%= rails_blob_path(audio_message.audio_file, disposition: "inline") %>" type="<%= audio_message.audio_file.content_type %>">
            Your browser does not support the audio element.
          </audio>
        </div>
      <% end %>
      <% if audio_message.transcription? %>
        <div class="mt-3 ml-13 bg-gray-50 rounded-lg p-3">
          <p class="text-xs font-medium text-gray-500 mb-1">Transcription</p>
          <p class="text-sm text-gray-700"><%= audio_message.transcription %></p>
        </div>
      <% end %>
    </div>
    <div class="flex items-center space-x-2 ml-4">
      <% unless audio_message.transcription? %>
        <%= button_to "Transcribe", transcribe_field_field_visit_audio_message_path(audio_message.field_visit.field, audio_message.field_visit, audio_message),
            method: :post,
            class: "text-xs px-2 py-1 bg-blue-100 text-blue-700 rounded hover:bg-blue-200 transition" %>
      <% end %>
      <%= button_to field_field_visit_audio_message_path(audio_message.field_visit.field, audio_message.field_visit, audio_message),
          method: :delete,
          data: { turbo_confirm: "Delete this recording?" },
          class: "text-gray-400 hover:text-red-500 transition" do %>
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
        </svg>
      <% end %>
    </div>
  </div>
</div>
